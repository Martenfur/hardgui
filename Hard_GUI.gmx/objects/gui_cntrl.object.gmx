<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///FORMS
scissorsInit()

formListDraw=ds_grid_create(0,2) //form lists
formListClick=ds_list_create()

//drag
windowDrag=  0     //drag enabling
windowDragId=noone //a window to drag
windowDragDx=0     //delta between mouse x and form x
windowDrawDy=0     //delta between mouse y and form y 
//drag

//FORM IMITATION
w=        room_width 
h=        room_height
myform=   noone

/*
0 - Mouse's not in form.
1 - Mouse is in form.
2 - Mouse is in form, but it's blocked by child form.
*/
clickable=0
global.clickHolder=noone
clickHolderReset=0
//FORM IMITATION

allstr='!"#$%&amp;'+"'"+'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёжзийклмнопрстуфхцчшщъыьэюя '

global.gui_font=font_add_sprite_ext(s_gui_font,allstr,1,2)
global.gui_c_bright=make_color_rgb(239,255,205)
global.gui_c_medium=make_color_rgb( 85, 81, 82)
global.gui_c_dark=  make_color_rgb( 46, 38, 51)


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///KEY COMBINATIONS

/*

0 - current state
1 - previous state
2 - list of keys
3 - function
4 - function args

*/

keyCombo=ds_list_create()

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///CONTEXT MENU

contextMenu_x=0
contextMenu_y=0
contextMenu_w=0
contextMenu_h=0

contextMenu_wmin=192

contextMenuButtonSelected=-1
contextMenuButtonPressed= -1
contextMenuButtonPressedId=noone

contextMenuActiveId=noone


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///GLOBAL SET VARS

defForm=    ds_stack_create()
defSlider_h=ds_stack_create()
defSlider_v=ds_stack_create()

ds_stack_push(defForm,NOFORM)
ds_stack_push(defSlider_h,NOSLIDER)
ds_stack_push(defSlider_v,NOSLIDER)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///CONTEXT MENU

contextMenuButtonSelected=-1
contextMenuButtonPressed= -1
contextMenuButtonPressedId=noone

if contextMenuActiveId!=noone
{
  if mouse_check_button(mb_left) || mouse_check_button_released(mb_left) 
  {  
    if point_in_rectangle(mouse_x,mouse_y,contextMenu_x,    contextMenu_y,
                                          contextMenu_x+contextMenu_w,contextMenu_y+contextMenu_h)
    {
      var contextMenuL=ds_list_size(contextMenuActiveId);
      for(var i=0; i&lt;contextMenuL i+=1)
      {
        if point_in_rectangle(mouse_x,mouse_y,contextMenu_x,    contextMenu_y+GUI_SPACING_4X*i,
                                              contextMenu_x+contextMenu_w,contextMenu_y+GUI_SPACING_4X*(i+1))
        {
          contextMenuButtonSelected=i
          break
        }
      }
    } 
  }
 
  if mouse_check_button_released(mb_left)  
  {
    contextMenuButtonPressed=  contextMenuButtonSelected
    contextMenuButtonPressedId=contextMenuActiveId
    
    if contextMenuButtonSelected!=-1
    {
      var contextMenuItemCur=contextMenuActiveId[|contextMenuButtonSelected]
      if contextMenuItemCur[|1]!=-1
      {script_execute(contextMenuItemCur[|1],contextMenuItemCur[|2])}
    }
    
    contextMenuActiveId=noone
  }
}


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///CLICK PROCESSING

var mbCheckGlobal,mbCheckPressGlobal,mbCheckReleaseGlobal;

clickable=1
if contextMenuButtonSelected=-1 &amp;&amp; contextMenuActiveId=noone
{
  mbCheckGlobal=       mouse_check_button         (mb_left)
  mbCheckPressGlobal=  mouse_check_button_pressed (mb_left)
  mbCheckReleaseGlobal=mouse_check_button_released(mb_left)
  
  if clickHolderReset
  {
    clickHolderReset=0
    global.clickHolder=noone //Reset must me delayed by one step to work with Release event.
  }
  if mbCheckReleaseGlobal
  {clickHolderReset=1}
}
else
{
  mbCheckGlobal=       0
  mbCheckPressGlobal=  0
  mbCheckReleaseGlobal=0
}



var listL=ds_list_size(formListClick);

//resetting click
with(gui_form)
{clickable=0}
//resetting click

if !windowDrag
{ 
  //WINDOW DRAG//////////////////////////////////////////////////////////////////////////////////////////
  for(var i=0; i&lt;listL i+=1)
  { 
    if formListClick[|i].isWindow 
    &amp;&amp; formListClick[|i].active!=-1 
    &amp;&amp; gui_formCheckActivity(formListClick[|i].myform) 
    &amp;&amp; !gui_formCheckOverlay(mouse_x,mouse_y,formListClick[|i])
    {
    
      
        
      if _gui_formCheckRegionInsideParent(mouse_x,mouse_y,0,-GUI_SPACING_4X,formListClick[|i].w,0,formListClick[|i])
      {
        _gui_formClickGive(formListClick[|i],2)
        
        //HIDE BUTTON
        if formListClick[|i].bHideEn 
        &amp;&amp; _gui_formCheckRegionInsideParent(mouse_x,mouse_y,formListClick[|i].w-GUI_SPACING_4X*2,-GUI_SPACING_4X,formListClick[|i].w-GUI_SPACING_4X,0,formListClick[|i])
        {
          if mbCheckPressGlobal
          {
            formListClick[|i].bHidePressed=1
            gui_clickTake()
          }
           
          if formListClick[|i].bHidePressed=1
          {      
            if mbCheckReleaseGlobal
            {formListClick[|i].bHideCheck=1}
            if mbCheckGlobal
            {formListClick[|i].bHideHighlight=1}    
          }
        }
        //HIDE BUTTON
        else
        {         
          //CLOSE BUTTON
          if formListClick[|i].bCloseEn
          &amp;&amp; _gui_formCheckRegionInsideParent(mouse_x,mouse_y,formListClick[|i].w-GUI_SPACING_4X,-GUI_SPACING_4X,formListClick[|i].w,0,formListClick[|i])
          {
            if mbCheckPressGlobal
            {
              formListClick[|i].bClosePressed=1
              gui_clickTake()
            }
            
            if formListClick[|i].bClosePressed=1
            {
              if mbCheckReleaseGlobal
              {formListClick[|i].bCloseCheck=1}
              if mbCheckGlobal
              {formListClick[|i].bCloseHighlight=1}
            }
            
          }
          //CLOSE BUTTON
          else
          //DRAG
          {
            if mbCheckPressGlobal
            {
              windowDragId=formListClick[|i]
              windowDragDx=mouse_x-xGlobal
              windowDragDy=mouse_y-yGlobal+GUI_SPACING_4X
              windowDrag=  1
              clickReset=  0
            }
          }
          //DRAG
        }
        
        if mbCheckPressGlobal
        {_gui_formPopupWindow(formListClick[|i])} 
        
        if mbCheckReleaseGlobal
        {
          formListClick[|i].bClosePressed=0
          formListClick[|i].bHidePressed=0 
        } 
        
        break
      }
      
      if mbCheckReleaseGlobal
      {
        formListClick[|i].bClosePressed=0
        formListClick[|i].bHidePressed=0 
      }
    }
  }  
  //WINDOW DRAG//////////////////////////////////////////////////////////////////////////////////////////
} 

/*
NOTE: 
You CANNOT merge these two blocks under one if, even though they got identical condition.
windowDrag may change in first block.
*/

if !windowDrag
{
  //CLICK PROCESSING/////////////////////////////////////////////////////////////////////////////////////
  if clickable==1
  {
    for(var i=0; i&lt;listL i+=1)
    {
      if gui_formCheckActivity(formListClick[|i]) 
      {
        gui_formGetGlobalCoords(formListClick[|i]) //getting coordinates
        
        //CHECKING CLICK
        if point_in_rectangle(mouse_x,mouse_y,
                              xGlobal,yGlobal,
                              xGlobal+formListClick[|i].w,yGlobal+formListClick[|i].h)
        {
          if _gui_formCheckRegionInsideParent(mouse_x,mouse_y,0,0,formListClick[|i].w,formListClick[|i].h,formListClick[|i])
          { 
            _gui_formClickGive(formListClick[|i],1)
            
            if mbCheckPressGlobal //popup
            {_gui_formPopupWindow(formListClick[|i])}
            
            break
          }  
        }
        //CHECKING CLICK
      }
    }
  }
  //CLICK PROCESSING/////////////////////////////////////////////////////////////////////////////////////  
}
else
{
  //DRAGGING
  with(windowDragId)
  {
    gui_formGetGlobalCoords(myform) //getting coordinates

    headerX=mouse_x-xGlobal-other.windowDragDx
    headerY=mouse_y-yGlobal-other.windowDragDy
  
    //drag borders
    var w_bor,h_bor;
  
    if instance_exists(myform)
    {
      w_bor=myform.w-w
      h_bor=myform.h-GUI_SPACING_4X 
    }
    else
    {
      w_bor=room_width-w
      h_bor=room_height-GUI_SPACING_4X
    }
  
    if w&lt;myform.w
    {
      if headerX&lt;0
      {headerX=0}
      if headerX&gt;w_bor
      {headerX=w_bor}
    }
    else
    {
     if headerX&gt;0
     {headerX=0}
     if headerX&lt;w_bor
     {headerX=w_bor}
    }
    if headerY&lt;0
    {headerY=0}
    if headerY&gt;h_bor
    {headerY=h_bor}
    //drag borders
  }
 
  //drag disabling
  if mbCheckReleaseGlobal || !mbCheckGlobal || windowDragId=noone
  {
    windowDrag= 0
    windowDragId=noone
  }
  //drag disabling
 
  clickable=0 //click resetting
 
  //DRAGGING
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///KEY COMBINATIONS

var keyComboCheck;
var keyComboSize=ds_list_size(keyCombo);

for(var i=0; i&lt;keyComboSize i+=1)
{
  keyComboCheck=keyCombo[|i]

  keyComboCheck[|1]=keyComboCheck[|0]
  keyComboCheck[|0]=1
 
  var keyComboKeyList=keyComboCheck[|2];
  var keyComboKeyListSize=ds_list_size(keyComboKeyList);
  
  for(var k=0; k&lt;keyComboKeyListSize k+=1)
  {
    if !keyboard_check(keyComboKeyList[|k])
    {
      keyComboCheck[|0]=0
      break
    }
  }
  
  if ds_list_size(keyComboCheck)&gt;3 &amp;&amp; keyComboCheck[|0] &amp;&amp; !keyComboCheck[|1]
  {script_execute(keyComboCheck[|3],keyComboCheck[|4])}
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///DRAWING CONTEXT MENU

if contextMenuActiveId!=noone
{
  var contextMenuL=ds_list_size(contextMenuActiveId);
  
  draw_sprite_stretched_ext(s_pixel,0,contextMenu_x-1,contextMenu_y-1,contextMenu_w+2,contextMenu_h+2,GUI_C_DARK,1)
  draw_sprite_stretched_ext(s_pixel,0,contextMenu_x,  contextMenu_y,  contextMenu_w,  contextMenu_h,GUI_C_MEDIUM,1)
  
  draw_set_halign(fa_left)
  draw_set_valign(fa_center)
  draw_set_color(GUI_C_BRIGHT)
  
  for(var i=0; i&lt;contextMenuL i+=1)
  {
    var contextMenuItemCur=contextMenuActiveId[|i];
    if contextMenuButtonSelected=i
    {
      draw_sprite_stretched_ext(s_pixel,0,contextMenu_x,contextMenu_y+GUI_SPACING_4X*i,contextMenu_w,GUI_SPACING_4X,GUI_C_BRIGHT,1)
      draw_set_color(GUI_C_DARK)
      draw_text(contextMenu_x+GUI_SPACING,contextMenu_y+GUI_SPACING_4X*(i+0.5),contextMenuItemCur[|0])
      draw_set_color(GUI_C_BRIGHT)
    }
    else
    {draw_text(contextMenu_x+GUI_SPACING,contextMenu_y+GUI_SPACING_4X*(i+0.5),contextMenuItemCur[|0])}
  }
}


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///DRAWING FORMS

for(var i=0; i&lt;ds_grid_width(formListDraw) i+=1)
{
  with(formListDraw[#i,0])
  {
    if !surface_exists(surf)
    {surf=surface_create(w,h)}
    
    //Draw events.
    surface_set_target(surf)
    var myobjectsL=ds_list_size(myobjects);
    for(var ev=0; ev&lt;3 ev+=1)
    {
      for(var k=0; k&lt;myobjectsL k+=1)
      {
        with(myobjects[|k])
        {
          if __eventDRAW[ev]!=NOEVENT
          {script_execute(__eventDRAW[ev])}
        }
      }
    }
    surface_reset_target()    
    //Draw events.
    
    if other.formListDraw[#i,1]&gt;=1 //checking if form is in another form
    {surface_set_target(myform.surf)}
    if !isWindow
    {
      if active
      {draw_surface(surf,x,y)}
    }
    else
    {_gui_windowDraw()}
    if other.formListDraw[#i,1]&gt;=1 //checking if form is in another form
    {surface_reset_target()}
     
    //if !surface_exists(surf)
    //{surf=surface_create(w,h)}
    
    surface_set_target(surf)
    draw_clear_alpha(cBkg,1)
    surface_reset_target()
  }
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
